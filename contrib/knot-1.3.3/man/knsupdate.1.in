.TH "knsupdate" "1" "@RELEASE_DATE@" "CZ.NIC Labs" "Knot DNS, version @VERSION@"
.SH NAME
.TP 10
.B knsupdate
\- Dynamic DNS update utility (libknot equivalent of ISC nsupdate)
.SH SYNOPSIS
.B knsupdate
[\fIoptions\fR] [\fIfilename\fR]
.SH DESCRIPTION
The utility sends Dynamic DNS update message to DNS server. Update content is
read from a file (if the parameter \fIfilename\fR is given) or from standard
input. The format of the update is described in \fBINPUT FORMAT\fR section.
.SH OPTIONS
.TP 4
.B \-d
Enable debugging messages.
.TP
.B \-v
Use TCP protocol instead of the default UDP.
.TP
.BI \-p \ port
Set the port to use for connections to a server (if not explicitly
specified in the update). The default is \fI53\fR.
.TP
.BI \-t \ timeout
The total timeout (all UDP update tries) of the update request in seconds. The default is \fI12\fR. If set to
zero, the timeout is infinite.
.TP
.BI \-r \ retries
The number of retries for UDP requests. The default is \fI3\fR.
.TP
.BI \-k \ keyfile
Use TSIG or SIG\-0 key stored in file to authenticate the request. The tool
supports keys generated by ISC \fBdnssec\-keygen\fR. The key comprises of
public (.key extension) and private part (.private extension). Either of these
file names or a name without the extension can be specified as \fIkeyfile\fR
parameter.
.TP
.BI \-y \ \fR[\fIhmac:\fR]\fIname:key
Use TSIG key to authenticate the request. The \fIhmac\fR part specifies the
algorithm (the default is hmac\-md5), \fIname\fR specifies the key name, and
\fIkey\fR specifies the shared secret encoded in Base64.
.TP
.BR \-h ,\  \-\-help
Print help.
.TP
.BR \-V ,\  \-\-version
Print program version.
.SH NOTE
Options \fB\-k\fR and \fB\-y\fR cannot be used mutually.
.SH INPUT FORMAT
The input format is textual and is made up of commands. Every command is placed
on a separate line of the input. Lines starting with a semicolon are comments
and are not processed.
.TP
List of commands format and their description:
.TP
.BI server \ name \ \fR[\fIport\fR]
Specifies a receiving server of the dynamic update message. Parameter \fIname\fR
can be either a host name or an IP address. If the \fIport\fR is not specified,
default port is used. The default port value can be controlled using program
option \fB\-p\fR.
.TP
.BI local \ address \ \fR[\fIport\fR]
Specifies outgoing \fIaddress\fR and \fIport\fR. If no local is specified,
the address and port are set by the system automatically. Default port number
is \fI0\fR.
.TP
.BI zone \ name
Specifies that all updates are done within a zone named \fIname\fR. If not used,
the default zone is the root zone.
.TP
.BI origin \ name
Specifies fully qualified domain name suffix which is appended to
non\-fqd owners in update commands. The default origin is the root zone.
.TP
.BI class \ name
Sets \fIname\fR as a default class for all updates. If not used, the default
class is \fIIN\fR.
.TP
.BI ttl \ value
Sets \fIvalue\fR as a default TTL (time to live) in seconds. If not used, the
default value is \fI0\fR.
.TP
.BI key \ name \ \fIkey\fR
Specifies TSIG key to authenticate the request. This command has the same
semantics as the program option \fB\-y\fR, except that the MAC algorithm
cannot be set.
.TP
[\fBupdate\fR] \fBadd\fR \fIname\fR [\fIttl\fR] [\fIclass\fR] \fItype\fR \fIdata\fR
Adds a request to add a new resource record into the zone. Please note that if the
\fIname\fR is not fully qualified domain name, current \fIorigin\fR name is appended to it.
.TP
[\fBupdate\fR] \fBdel\fR[\fBete\fR] \fIname\fR [\fIttl\fR] [\fIclass\fR] [\fItype\fR] [\fIdata\fR]
Adds a request to remove all (or matching \fIclass\fR, \fItype\fR, \fIdata\fR)
resource records from the zone. There is the same requirement for the
\fIname\fR parameter as in the \fBupdate add\fR command. The \fIttl\fR item is ignored.
.TP
.B show
Displays current content of the update message.
.TP
.B send
Sends the current update message and cleans the list of updates.
.TP
.B answer
Displays the last answer from the server.
.TP
.B debug
Enable debugging. This command has the same meaning as program option \fB\-d\fR.
.SH NOTE
.SS Missing features with regard to ISC nsupdate
Options \fB\-D\fR, \fB\-g\fR, \fB\-o\fR, \fB\-l\fR, \fB\-L\fR, \fB\-R\fR, \fB\-u\fR.
.TP
Commands: \fBgsstsig\fR, \fBoldgsstsig\fR, \fBrealm\fR, \fBprereq\fR (\fBnxdomain\fR, \fByxdomain\fR, \fBnxrrset\fR, \fByxrrset\fR).
.SS Differences with regard to ISC nsupdate
Zone name/server guessing, if the zone name/server is not specified.
.TP 0
Empty line doesn't send an update.
.TP
Bind-like key format (\fBddns\-confgen\fR output) is not supported.
.TP
Command \fBadd\fR doesn't require \fIttl\fR item to be set. In such case,
the default ttl value is used.
.SH EXAMPLES
.B Example 1. Add two records to the zone example.com.:
.TP 0
.nf
knsupdate
server 192.168.1.1
zone example.com.
origin example.com.
ttl 3600
add test1.example.com. 7200 A 192.168.2.2
add test2 TXT "hello"
show
send
answer
.fi
.SH AUTHOR
Marek Vavruša, Daniel Salzman, Jan Včelák (\fBwww.knot\-dns.cz\fR)
.TP
Please send any bug reports or comments to \fBknot\-dns@labs.nic.cz\fR
.SH SEE ALSO
.BR kdig (1),
.BR khost (1).
